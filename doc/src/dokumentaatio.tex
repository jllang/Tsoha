\documentclass[11pt]{article}
\usepackage[finnish]{babel}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{float}
\usepackage{epstopdf}
\usepackage{tikz}
\definecolor{sininen}{HTML}{CCE6FF}
\definecolor{vihrea}{HTML}{CCFFCC}
\definecolor{keltainen}{HTML}{FFEFCC}
\definecolor{punainen}{HTML}{FFC0CB}
\definecolor{valkoinen}{HTML}{FFFFFF}
\definecolor{harmaa1}{rgb}{0.9, 0.9, 0.9}
\definecolor{harmaa2}{rgb}{0.8, 0.8, 0.8}
\definecolor{harmaa3}{rgb}{0.7, 0.7, 0.7}
\renewcommand*{\familydefault}{\sfdefault}
\title{\textbf{Keskustelufoorumi}\\ \small{dokumentaatio}}
\author{John Lång}
\date{3.6.2014}
\begin{document}

\maketitle

\thispagestyle{empty}
%Tehty \LaTeX:lla.

\newpage
%Pystyyköhän tälle jotenkin antamaan oman suomenkielisen otsikon?
\tableofcontents
\thispagestyle{empty}

\newpage

\section{Johdanto}
	Tämän projektin tarkoituksena on toteuttaa perinteinen web-pohjainen keskus-telufoorumi. Ohjelmiston
	avulla internetin käyttäjät voivat perustaa omia (yleen-sä tiettyyn aihepiiriin keskittyviä) yhteisöjään
	joihin jokainen rekisteröity jäsen voi tuottaa omaa sisältöään (yhteisön sääntöjen mukaisesti). Lisäksi
	projektin tavoitteena on luonnollisesti tarjota mahdollisimman tehokkaat ja käyttäjäystä-välliset työkalut 
	foorumin ylläpidosta sekä moderoinnista vastaaville yhteisön jäsenille, jotta he voisivat suorittaa
	tehtäväänsä	tarkoituksenmukaisesti.
		
	Aion toteuttaa projektin käyttämällä java-ohjelmointikieltä Netbeans IDE:llä sekä (Tietojenkäsittelytieteen laitoksen
	palvelimille asennettuja) PostgreSQL-tietokantaa ja Apache Tomcat -http-palvelinta. Loppukäyttäjälle
	näkyvän sivuston ulkoasun aion toteuttaa HTML 5- sekä mahdollisesti CSS-kielten avulla. Tavoitteenani
	on myös salata mahdollisimman suuri osa foorumin tietoliikenteestä HTTPS-protokollan avulla.
	
	Itse tämän dokumentin laatimisessa olen käyttänyt hyväkseni avoimen lähde-koodin ohjelmistoja.
	Gummi:lla olen tehnyt itse pdf-tiedoston, Dialla (UML-)\\ kaaviot, LibreOffice Calc:lla käyttötapausmallin
	taulukot, sekä Inkscapella muuttanut nämä kuvat eps-formaattiin pdf-tiedostoon liittämistä varten.
	
	Pyrkimyksenäni on pitää järjestelmän vaatima asennustyö minimissä enkä siksi aio käyttää muita kun kielten
	standardikirjastoja sekä mainitsemiani palvelin-ohjelmistoja. Lisäksi aion tehdä ohjelmistostani mahdollisimman näkymättömän loppukäyttäjälle
	siten, ettei foorumin käyttäminen edellytä mitään selainliitän-näisiä tai javascriptin käyttöä. Luultavasti
	joudun kuitenkin (valitettavasti) käyt-tämään evästeitä esimerkiksi käyttäjäkohtaisten istunto- ja
	asetustietojen tallentamiseen.
	
	Olen valinnut projektilleni MIT-lisenssin, joka löytyy juurihakemiston tiedostosta LICENCE.
	% Tämän voisi varmaan mainita myös README.md:ssä
\newpage

\section{Yleiskuva}
	\subsection{Keskustelufoorumi}
		Keskustelufoorumi koostuu erilaisista lomakkeista ja työkaluista, joiden avulla järjestelmän tilaa
		muokataan, sekä tasopohjaisesta pääsynvalvonnasta neljällä eri \emph{käyttäjätasolla}.\footnote{
		Myöhemmin saatan ehkä lisätä myös käyttäjäryhmät, joiden perusteella voitaisiin valvoa
		pääsyä eri keskustelualueille saman kategorian käyttäjätunnusten keskuudessa.}
	
	\subsection{Käyttäjätasot}
		% Mitäpä jos olisi sellainen "puheoikeudeton" käyttäjätaso jonka käyttäjät saisivata vain käyttää
		% hakutoimintoja?
		Käyttäjätasot ovat \emph{vierailija}, \emph{jäsen}, \emph{moderaattori} ja \emph{ylläpitäjä}.
		Tasoihin liittyvät käyttöoikeudet ovat sisäkkäisiä siten, että vierailijalla on kaikkein suppeimmat
		ja ylläpitäjällä laajimmat käyttöoikeudet. Toisin sanoen ylläpitäjän oikeuksiin sisältyy kaikkien
		muiden tasojen oikeudet. Ylläpitäjä on keskustelufoorumin käyttöönoton suorittava henkilö. Alla on
		Vennin kaavio käyttäjätasoista.
	
		\begin{figure}[H]
			\vspace{1cm}
			\centering
			\begin{tikzpicture}
				\draw[fill=sininen] (0,1.5) circle(3.25);
				\draw[fill=vihrea] (0,1) circle(2.5);
				\draw[fill=keltainen] (0,0.5) circle(1.75);
				\draw[fill=punainen] circle(1);
				\node at (0,0) {ylläpitäjä};
				\node at (0,1.5) {moderaattori};
				\node at (0,2.75) {jäsen};
				\node at (0,4) {vierailija};
			\end{tikzpicture}\\
			\caption{Käyttäjätasot}
		\end{figure}
	
	\newpage
	\subsection{Rakenne ja toiminnot}
		Foorumin toiminnallisuuden ytimessä ovat käyttäjien tuottamaa sisältöä säilövät
		\emph{ketjut}\footnote{Käytän ketjusta myös synonyymiä \emph{viestiketju}.}, jotka
		sijaitsevat \emph{keskustelualueilla}. Lähtökohtaisesti kuka tahansa kes-kustelufoorumin web-sivustolla
		surffaava käyttäjä eli vierailija voi \emph{selata} keskuste-lualueita ja lukea niissä olevien ketjujen
		\emph{viestejä}.\footnote{
		Tavoitteenani on luoda ensin vain litteä hierarkia sisältäen yhden tasoisia keskustelualueita,
		joissa on vierailijoille näkyviä tavallisia ketjuja. Jos aikaa jää, saatan myös toteuttaa esimerkiksi
		sisäkkäisiä ja vierailijoilta piilotettuja keskustelualueita.}
		Lisäksi vierailija voi rekis-teröidä itselleen käyttäjätunnuksen.	
	
		\begin{figure}[H]
			\centering
			\begin{tikzpicture}
				\draw[fill=harmaa3] (0,1.5) circle(3.25);
				\draw[fill=harmaa2] (0,1) circle(2.5);
				\draw[fill=harmaa1] (0,0.5) circle(1.75);
				\draw[fill=valkoinen] circle(1);
				\node at (0,0) {viesti};
				\node at (0,1.5) {ketju};
				\node at (0,2.75) {keskustelualue};
				\node at (0,4) {foorumi};
			\end{tikzpicture}\\
			\caption{Foorumin rakenne}
		\end{figure}
	
		Jokainen rekisteröity käyttäjä eli jäsen voi aloittaa uuden ketjun sekä lisätä, muokata ja poistaa
		omia viestejään lukitsemattomissa ketjuissa. Näistä operaa-tioista käytän yhteisesti ilmausta
		\emph{viestitoiminnot}. Viestitoimintojen lisäksi jäse-net voivat käyttää \emph{hakutoimintoa}
		ketjujen ja viestien etsimiseen sekä muokata muille näytettäviä tietoja \emph{käyttäjätunnustoiminnoissa}. On syytä huomata että jäsentason käyttöoikeudet siis liittyvät
		\emph{käyttäjätunnuksiin} eli niiden käyttö edellyttää \emph{sisäänkirjautumista}.
	
		Moderaattorit ovat laajemmilla oikeuksilla toimivia
		käyttäjiä jotka voivat käsitellä mitä tahansa ketjun viestiä sekä lukita ja avata ketjun taikka siirtää
		sen toiselle keskustelualueelle.\footnote{Näin alkuvaiheessa en aio luvata mitään hienompia
		ominaisuuksia, kuten esimerkiksi ketjun määrittäminen \emph{tiedotteeksi} (joka saisi ketjun näkymään
		keskustelualueen listauksessa ennen tavallisia ketjuja).}
		Näistä toiminnoista käytän nimitystä \emph{moderointi}.
		Moderaattorien toimenkuvana on pitää huolta siitä että ketjujen ja viestien sisäl-tö vastaa foorumin
		tarkoitusta.\footnote{Foorumin tarkoitutksesta päättää ylläpitäjä ja siten asia on projektini
		aihealueen ulkopuolella.}
		Moderoinnin lisäksi moderaattoreilla on oikeus antaa \emph{porttikieltoja} jäsenille. Porttikiellot
		estävät sisäänkirjautumisen ja kohdistuvat käyttäjätunnuksiin (ei esimerkiksi IP-osoitteisiin, sillä
		niiden estäminen ei ole tehokasta ja voi haitata sivullisia).
	
		Viimeinen käyttäjätaso on ylläpitäjä. Ylläpitäjät voivat poistaa käyttäjätun-nuksen sekä korottaa taikka
		alentaa sen tasoa. Näissä toiminnoissa on kyse \emph{käyttäjätunnusten hallinnasta}. Lisäksi ylläpitäjä
		voi \emph{hallita keskustelualueita} eli perustaa, muokata tai poistaa keskustelualueen.
	
	\subsection{Käyttötapaukset}
		Edellä esitettyä vastaa seuraava käyttötapauskaavio:
		\begin{figure}[H]
			\centering
			\includegraphics[trim = 7mm 0mm 0mm 0mm,scale=1.5]{kayttotapauskaavio.eps}\\
			\caption{Käyttötapauskaavio}
		\end{figure}
	
		Luettelen seuraavaksi maineikasta Alistair Cockburnin käyttötapausmallia\footnote{
		[Linkki tulossa...]}
		vapaasti mukaillen ohjelmistoni tärkeimmät käyttötapaukset.
	
		Seuraavat yhdeksän sivua sisältävät siis projektin käyttötapausmallit tauluk-komuotoisessa esityksessä.
	
		Selkeyden vuoksi olen käyttänyt taulukoissa samaa värikoodauta kuin käyttö-tapauskaavioissa erottamaan
		eri käyttäjätasojen käyttötapaukset. Olen myös merkinnyt tähdellä (*) ne käyttötapausten vaiheet,
		jotka ovat valinnaisia. Valinnaisen vaiheen voi jättää kokonaan tekemättä. Jos valinnainen vaihe
		sisältää syötteen antamista, niin käyttäjä voi antaa tyhjän syötteen. Jos valinnainen vaihe ohitetaan,
		ei siltä osin muuteta tietokannassa olemassaolevia tietoja. (Toi-saalta tyhjä syöte tyhjentää jonkin
		kentän arvon sitä vastaavassa tietokannan monikon attribuutissa ja merkitsee siten eri asiaa kuin
		vaiheen ohittaminen).\footnote{Lisäksi käyttötapauksessa 3 on syytä huomata, että käyttäjätunnuksen
		kirjautumisnimi määräytyy käyttäjätunnusta rekisteröitäessä eikä sitä voi jälkikäteen vaihtaa.}
	
		\newpage
		\pagestyle{empty}
		\includegraphics[trim = 27mm 0mm 0mm 25mm]{kayttotapausmalli-sivu-1.eps}\\
		\includegraphics[trim = 21mm 0mm 0mm 25mm]{kayttotapausmalli-sivu-2.eps}\\
		\includegraphics[trim = 21mm 0mm 0mm 25mm]{kayttotapausmalli-sivu-3.eps}\\
		\includegraphics[trim = 21mm 0mm 0mm 25mm]{kayttotapausmalli-sivu-4.eps}\\
		\includegraphics[trim = 21mm 0mm 0mm 25mm]{kayttotapausmalli-sivu-5.eps}\\
		\includegraphics[trim = 21mm 0mm 0mm 25mm]{kayttotapausmalli-sivu-6.eps}\\
		\includegraphics[trim = 21mm 0mm 0mm 25mm]{kayttotapausmalli-sivu-7.eps}\\
		\includegraphics[trim = 21mm 0mm 0mm 25mm]{kayttotapausmalli-sivu-8.eps}\\
		\includegraphics[trim = 21mm 0mm 0mm 25mm]{kayttotapausmalli-sivu-9.eps}\\
		
		% Ylläolevat lasken "yhdeksi" kuvaksi...
		\begin{figure}
			\caption{Käyttötapausmalli}
		\end{figure}

\newpage
\thispagestyle{plain}
\section{Tietosisältö}
	\subsection{Tietovaatimukset}
		Edellisessä kappaleessa esittämäni foorumin yleiskuvan perusteella olen päätynyt siihen tulokseen,
		että järjestelmässä on neljä varsinaista yksilötyyppiä. Yksilötyy-pit ovat \emph{jäsen, viesti, ketju}
		ja \emph{keskustelualue}. Vierailijoille ei tarvita mitään tauluja tietokannassa sillä nämä eivät
		voi tuottaa sisältöä foorumille (vaikka voivatkin esimerkiksi lukea viestitauluja).		
		
	\subsection{Käsitekaavio} Alla on käsitekaavio keskeisimmistä tietokohteista:
		\begin{figure}[H]		
			\includegraphics[trim = 0mm 0mm 0mm -3mm, scale = 2.0]{kasitekaavio.eps}
			\caption{Käsitekaavio}
		\end{figure}	
		
	\subsection{Tietokohteet} Seuraavalla sivulla olen listannut lyhyen taulukkomuotoisen kuvauksen edellä
		esi-tetyistä tietokohteista. Arvojoukolla merkkijono($n$) viittaan vaihtuvan mittaisiin korkeintaan
		$n$ merkkiä pitkiin merkkijonoihin.
	
		\newpage
		\thispagestyle{plain}
		
		\begin{figure}[H]
			\includegraphics{tietokohteet.eps}
			\caption{Tietokohteet}
		\end{figure}
		
\newpage
\thispagestyle{plain}		
	\section{Relaatiotietokantakaaviot}
		\subsection{ER-kaavio} Seuraavalla sivulla on tietokannan riippuvuuksia korkealla tasolla kuvaava
		ER-kaavio. Olen esittänyt siinä kohteiden tyypit väreillä, mikä ilmenee kuvassa ole-vasta selityksestä.
		Lisäksi selvennettäköön, että olen tilan säästämiseksi niputtanut osan samankaltaisista attribuuteista
		yhteen moniarvoisiksi attribuuteiksi sekä viitannut porttikiellon asettamiseen potkimisena. Kaikki
		järjestelmän todelliset tietokantataulut ovat vähintään kolmannessa normaalimuodossa, joten moniarvoisia
		attribuutteja ei tietokannassani esiinny.
		
		\subsection{UML-kaavio} Olen myös laatinut tarkemman kaavion, josta ilmenee kaikki varsinaiseen
		tie-tokantaan luotavat taulut attribuutteineen ja avaimineen. UML-kaavio on sivulla 21. Olen merkinnyt
		ensisijaiset ja vierasavaimet stereotyypein $<<$PK$>>$ ja $<<$FK$>>$. Lisäksi olen värittänyt
		kaavioon varsinaisia yksilötyyppejä vastaavat taulut sinisellä, heikkoja yksilötyyppejä vastaavat
		taulut punaisella sekä muut taulut vihreällä taustavärillä.
		
		\newpage
		\thispagestyle{plain}
		\begin{figure}[H]		
			\includegraphics[trim = 6mm 0mm 0mm 20mm, scale = 1.5]{er-kaavio.eps}
			\caption{ER-kaavio}
		\end{figure}
		
		\newpage
		\thispagestyle{plain}
		\begin{figure}[H]		
			\includegraphics[trim = 0mm 0mm 0mm 20mm, scale = 1.5]{uml-tietokantakaavio.eps}
			\caption{Tietokantakaavio}
		\end{figure}
		
\newpage
\thispagestyle{plain}
	\section{Järjestelmän yleisrakenne}
		\subsection{Hakemistorakenne}
			Kuvaan tässä luvussa lyhyesti järjestelmän yleisrakennetta hakemistorakenteen muodossa.
			Projektin tärkein sisältö sijaitsee juurihakemiston alikansioissa \emph{doc}, \emph{src} ja
			\emph{web}.
	
		\subsection{/doc}
			Tämä hakemisto sisältää projektin dokumentaation, kuten muunmuassa tämän asiakirjan. Hakemistossa
			\emph{/doc/src} sijaitsee dokumentaation latex-lähdekoodi sekä kaaviot ja kuvat.
			
		\subsection{/src/java}
			Tämä hakemisto sisältää projektin MVC-mallin mukaiset kontrollerit ja mallit omissa
			alihakemistoissaan. Lisäksi hakemisto sisältää foorumin käyttöönoton kannalta tarpeellisen
			konfiguraatiotiedoston omassa alihakemistossaan.
			
			\emph{/src/java/kontrollerit} sisältää varsinaisia HTTP-pyyntöjä käsittelevät servletit. Sillä on
			myös kaksi alihakemistoa:
			
			\emph{/src/java/kontrollerit/tyokalut} sisältää työkaluluokkia joiden staattisia metodeja eri
			servletit voivat käyttää. Työkaluluokkiin olen pyrkinyt keräämään yleiskäyttöi-siä koodinpätkiä
			käytettäväksi kirjastometodien tapaan.
			
			\emph{/src/java/kontrollerit/tyypit} sisältää aputyyppejä. Esimerkiksi työkaluluokka
			\emph{Listaaja} käyttää aputyyppiä \emph{ListaAlkio}, joka mallintaa web-sivuilla esitettävän
			listausnäkymän yhden rivin sisältämiä tietoja.
			
			\emph{/src/java/mallit} taas sisältää MVC-mallin mukaiset mallitiedostot. Sen alihakemistot on
			nimetty käytetyn ohjelmointikielen mukaisesti.
			
			\emph{/src/java/mallit/java} sisältää järjestelmän yksilötyyppejä mallintavat Java-luokat,
			pääsynvalvonnan peruspilarina toimivan käyttäjätunnuksen tasoa mallintavan enumeroidun luokan
			sekä Yksilötyyppien tuonnista ja viennistä vastaavan luokan \emph{TietokantaDAO}. Viimeksi
			mainittu vastaa myös useamman yksilötyypin tietokantataulujen käyttöä vaativien transaktioiden
			toteuttamisesta.
			
			Viimeisenä alihakemistona mainittakoon \emph{/src/java/mallit/sql}, joka sisältää foorumin
			ylläpidon ja käyttöönoton kannalta tärkeimmät SQL-tiedostot. Foorumin käyttöönoton yhteydessä
			tarvitaan tiedostoa \emph{Alustus.sql}.
			
		\newpage
		\thispagestyle{plain}
		\subsection{/web}
			Hakemisto sisältää MVC-mallin mukaiset näkymätiedostot.
			
			\emph{/web/META-INF} on foorumin käyttöönoton kannalta tärkeä hakemisto, jossa sijaitseva 
			tiedosto \emph{content.xml} sisältää tietokantayhteyden muodostamiseen tarvittavat tiedot.
			Foorumin ylläpitäjän tulee käyttöönoton yhteydessä päivittää mainittuun tiedostoon tietokannan
			sijainti, käyttäjätunnus sekä salasana.
			
			\emph{/web/WEB-INF} sisältää äsken mainitun hakemiston tavoin tiedostoja jotka eivät näy
			web-sivuja selaaville asiakkaille. Kansiossa on konfiguraatiotiedosto \emph{web.xml} sekä yksi
			alihakemisto.
			
			\emph{/web/WEB-INF/tags} sisältää kirjastoja muistuttavia tag-tiedostoja. Niitä olen
			käyttänyt toisteisuuden vähentämiseen ja koodin rakenteen selkiyttämiseen näkymätiedostoissa.
			
			\emph{/web/jsp} sisältää näkymätiedostot, jotka voivat käyttää apunaan toistuvan tiedon
			esittämiseen tag-tiedostoja.
			
			\emph{/web/tyylit} puolestaan sisältää web-sivujen graafisen tyylin määrittelystä vastaavat
			CSS-tiedostot omissa tyylien mukaisissa alihakemistoissaan. Tällä hetkellä tyylejä on vain yksi
			ja sen tiedostot löytyvät alihakemistosta \emph{oletus}.
			
			\emph{/web/data}-hakemistossa sijaitsee muita kuin koodiksi tulkittavia tiedostoja. Sillä on
			kaksi alihakemistoa:
			
			\emph{/web/data/staattinen}, joka sisältää foorumin graafisessa esityksessä tarvittavia
			kuvatiedostoja; sekä
			
			\emph{/web/data/dynaaminen}, jossa puolestaan sijaitsee käyttäjien foorumille lä-hettämät
			tiedostot joita ei katsota osaksi ohjelmistoa. Esimerkiksi käyttäjien mahdolliset avatar-kuvat
			sekä viesteihin laittamat liitetiedostot tulevat tähän hakemistoon.
			
		\subsection{Muut hakemistot}
			Muita projektikansiosta mahdollisesti löytyviä hakemistoja ovat \emph{build}, \emph{dist},
			\emph{test}, \emph{nbproject} sekä piilohakemisto \emph{.git}. Nämä hakemistot eivät 
			varsinaisesti liity tässä dokumentissa käsiteltäviin asiakokonaisuuksiin, joten katson 
			parhaaksi ohittaa niiden käyttötarkoituksen kuvailemisen. (Kyseessä on projektin tekniseen
			toteutukseen liittyviä hakemistoja, jotka lienevät Java-ohjelmoijille entuudestaan tuttuja.)
			
			Sanotusta huolimatta tahdon huomauttaa että jos projektin 
			kääntää NetBeans IDE:llä, niin .war-arkisto ilmestyy kansioon /dist. Tämä arkisto voidaan
			sijoittaa \emph{Tomcat}-palvelimen \emph{webapps}-hakemistoon.
	
\newpage
\thispagestyle{plain}
	\section{Käyttöliittymä}
		\subsection{Käyttöliittymäkaavio} Seuraavalla sivulla näkyvä kaavio antaa yleiskuvan käyttöliittymän
		komponenteista ja niiden välisistä suhteista.\footnote{Minun on pakko myöntää, että kaavio on hieman
		ikävän näköinen kun se on suunnattu poikittain, mutta kaikkien näkymien välisten yhteyksin esittäminen
		olisi ollut mahdotonta muulla tavoin. (Käytin yli tunnin aikaa pelkästään komponenttien sijoitteluun 
		välttääkseni kaavion nuolten menemisen päällekkäin.)} (Päivitän komponenttien lopulliset tiedostonimet
		näkyviin myöhemmin.) Esityksen selkeyttämiseksi olen värikoodannut komponentit niiden käyttöön
		tarvittavaa pienintä käyttäjätasoa vastaavalla väril-lä aiempaa käytäntöäni vastaavasti. (Toisin sanoen
		kaikkien käytettävissä olevat komponentit ovat sinisiä, jäsenten käytettävissä olevat vihreitä,
		moderaattoreiden keltaisia sekä ylläpitäjän punaisia.) Lisäksi on syytä huomata että joihinkin
		komponentteihin liittyy	lisätoiminnallisuutta korkeammilla käyttäjätasoilla. Esi-merkiksi komponentti
		"Käyttäjätunnus" tarjoaa ylläpitäjälle palvelun, joka mahdollistaa kohteena olevan käyttäjätunnuksen
		käyttäjätason muuttamisen.
		
		\subsection{Komponentit} Luettelen seuraavaksi ne kaaviossa näkyvät komponentit (tai ehkä pikemminkin
		toiminnot), jotka olen tähän mennessä ehtinyt toteuttaa.
		
		\emph{Navigointi} on foorumin keskeisimpiä ominaisuuksia ja siihen liittyvät toiminnot ovat läsnä
		jokaisella sivulla. Tämän vuoksi navigaatioon liittyvä koodi sijaitsee tagitiedostossa nimeltä
		\emph{kehys.tag} ja se sisällytetään jokaiseen näkymätiedos-toon.
		
		\emph{Etusivusta} vastaa kontrolleri \emph{IndexServlet.java}, joka listaa foorumin keskuste-lualueet,
		viimeisimmät viestit sekä joitain tilastotietoja.
		
		\emph{Listaus} on toiminto, joka on toteutettu työkaluluokassa \emph{Listaaja.java}. Sen tehtävänä
		on tulostaa taulukkomuodossa tietokannan tilaa kuvastavia näkymiä.
		
		\emph{Kirjautuminen} on toteutettu luokassa \emph{IstuntoServlet.java} ja se kommunikoi mm.
		työkaluluokan \emph{Valvoja} kanssa.
		
		\emph{Viestien muokkaus} on kontrollerin \emph{ViestiServlet.java} vastuulla. Se kuuntelee kahta eri
		URL-kuviota (engl. URL pattern) ja ohjaa selaimen oikealle näkymäsi-vulle.
		
		\emph{Ketjujen lukeminen} suoritetaan kontrollerin \emph{KetjuServlet.java} kautta ja jäsen-ten
		\emph{profiilin} esittäminen kuuluu kontrollerille \emph{ProfiiliServlet.java}.
		
		\newpage
		\begin{figure}[H]		
			\includegraphics[trim = 0mm 0mm 23mm -7mm, scale = 1.5, angle = 90]{kayttoliittymakaavio.eps}
			\caption{Käyttöliittymäkaavio}
		\end{figure}
		
\newpage
\thispagestyle{plain}
	\section{Asentaminen}
		\subsection{Esivalmistelut} Oletan, että ylläpitäjä on tätä ohjetta lukiessaan jo asentanut 
		\emph{Apache Tomcat 7.0.53}\footnote{versio 7.0.28 ei ole yhteensopiva.} (tai omalla
		vastuullaan uudemman) web-palvelimen sekä \emph{PostgreSQL}\\ -tietokannan hallintaohjelmiston
		sekä luonut kaikki tarvittavat käyttäjätunnukset.
		
		\subsection{Varsinaiset toimenpiteet} Ensiksi projektikansio tai war-arkisto tulee sijoittaa
		palvelimen \emph{webapps}-hakemis-toon. Oletan seuraavaksi, että ylläpitäjä on siirtynyt
		komentotulkissa projektikansion juureen.
		
		Kun hakemistorakenne on luotu, tulee suorittaa tietokantataulut määrittelevä SQL-tiedosto komennolla
		\emph{psql src/java/mallit/sql/Alustus.sql}.\footnote{Tilanteesta riippuen saattaa olla
		tarpeellista määrittää esimerkiksi käyttäjä, tietokannan nimi sekä salasana asianmukaisin lipuin,
		joiden käyttöohjeet löytyvät psql:n manuaalista.}
		
		Seuraavaksi tulee tietokantayhteyden muodostamiseen tarvittavat tiedot täyt-tää tiedostoon
		\emph{web/META-inf/context.xml.dist} ja poistaa sen nimen perästä .dist-pääte. Kyseisessä tiedostossa
		on mainittu kommentissa mitä tietoja tulee täydentää. 
		
		(Tässä vaiheessa mainittakoon, että koska en kyennyt erinäisten teknisten vaikeuksien vuoksi täysin
		noudattamaan aikataulua, jäivät käyttäjätunnusten ja keskustelualueiden lisäystoiminnot toteuttamatta.
		Tällä hetkellä nämä toimenpiteet täytyy tehdä käsin tietokantakyselyillä, mikä on melko teknistä ja 
		vaatii sovelluksen sisäisen logiikan ja tietokantataulujen rakenteen tuntemista.)
		
		Kun kaikki nämä toimenpiteet on onnistuneesti suoritettu, on foorumi valmis käytettäväksi ja sivun
		voi avata yleisölle.
		
\newpage
\thispagestyle{plain}
	\section{Käyttöohje}
		\subsection{Esimerkkidata} Foorumin toimintoja pääsee helposti testaamaan suorittamalla (vasta
		alustetussa tietokannassa) psql-komentotulkilla kansiossa \emph{src/java/mallit/sql} sijaitseva
		tiedosto \emph{Esimerkkidata.sql}. Kyseisen tiedoston sisältämät \emph{insert}-lauseet lisäävät
		tietokantaan neljä keskustelualuetta sekä neljä käyttäjätunnusta.
		
		Käyttäjätunnukset ovat \emph{maija} (ylläpitäjä) salasanalla \emph{salasana}, \emph{esmer}
		(moderaattori) salasanalla \emph{1234}, \emph{mattimeik} salasanalla \emph{abcdef} sekä tRolli
		(pysyvässä porttikiellossa) salasanalla \emph{lällispöö}.
		
		%\subsection{}
		
\newpage
\thispagestyle{plain}
	\section{Omat kokemukset}

%\newpage
%\section{Relaatiotietokantakaavio}
	
\end{document}